# 用户故事：DICOM 图像转换

## 用户故事

作为医学影像技术员，我需要一个函数将DICOM图像数据转换为标准图像格式（如PNG、JPEG），以便于在非专业医疗软件中查看和共享。

## 验收标准

1. 能够从已加载的DICOM对象中提取像素数据
2. 将DICOM像素数据正确转换为指定的输出格式（PNG、JPEG、TIFF）
3. 支持调整窗宽/窗位（windowing）参数以优化图像对比度
4. 支持基本图像处理操作（如调整大小、旋转）
5. 保留原始DICOM的比例和方向信息
6. 可选择是否在输出图像中包含匿名化的患者信息水印
7. 提供适当的错误处理机制

## 技术约束

1. 使用Python 3.10+
2. 使用pydicom进行DICOM处理
3. 使用PIL/Pillow或OpenCV进行图像处理和转换
4. 实现为单个函数，接受DICOM对象和输出选项作为输入
5. 返回转换后的图像对象或保存至指定位置
6. 函数应该是无状态的，不依赖于外部资源（除库外）

## 注意事项

- 需处理不同模态DICOM图像的特性（CT、MRI、超声等）
- 考虑多帧DICOM文件的处理
- 处理特殊像素表示（有符号/无符号、位深度变化）
- 确保灰度DICOM正确转换为RGB格式（如需要）
- 对于大型DICOM文件，需考虑内存优化
- 在图像转换过程中，需尊重DICOM标准中的呈现意图（presentation intent） 