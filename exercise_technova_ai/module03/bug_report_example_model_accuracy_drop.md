# Bug 报告示例：MediScan v2.9 模型准确率在特定病例下降

**报告编号**: BUG-NB-MED-2023-042
**报告日期**: 2023-11-28
**报告人**: 王晓东 (QA 工程师)
**受影响模块**: MediScan v2.9 - 肺结节检测模型 (Model ID: LungNodule-ResNet50-v2.9.1)
**严重程度**: 主要 (Major)
**优先级**: 高 (High)

## 问题描述

在对 MediScan v2.9 版本的回归测试中，发现肺结节检测模型在处理一组特定来源（医院 B，设备型号 Siemens XYZ）的 CT 扫描图像时，其准确率（以 IoU > 0.5 为标准）从基线测试的 92% 下降至 78%。该问题在其他来源或设备型号的图像上未复现。

## 复现步骤

1.  **环境**: UAT 环境 (uat-mediscan.technova.ai)
2.  **测试数据集**: `HospitalB_SiemensXYZ_CT_Lung_Set03` (包含 200 张阳性病例和 500 张阴性病例)
3.  **操作**: 使用 MediScan v2.9 的批量处理 API ( `/api/v1/mediscan/batch_predict` ) 对上述数据集进行预测。
4.  **比对**: 将模型的预测结果与该数据集的 Ground Truth (由 3 名资深放射科医生标注) 进行比对，计算准确率、召回率、精确率。

## 实际结果

*   准确率: 78%
*   召回率: 75%
*   精确率: 81%
*   多个小型 (< 5mm) 实性结节被漏报 (False Negatives)。
*   部分血管断面被误报为结节 (False Positives)。

## 预期结果

根据基线测试 (`Baseline_MixedSource_CT_Lung_Set` 数据集) 和早期版本测试结果：

*   准确率: ≥ 90%
*   召回率: ≥ 88%
*   精确率: ≥ 90%

## 可能原因分析 (初步)

1.  **数据漂移 (Data Drift)**: 医院 B 的 Siemens XYZ 设备参数或扫描协议可能与训练集中的数据存在显著差异，导致模型泛化能力下降。
2.  **模型过拟合**: 模型可能对训练集中的特定特征（可能不包含医院 B 的数据特征）过拟合。
3.  **预处理问题**: 图像预处理步骤（如归一化、窗位调整）可能对该特定来源的图像处理不当。
4.  **Ground Truth 标注差异**: 需要确认 `HospitalB_SiemensXYZ_CT_Lung_Set03` 数据集的标注质量和一致性。

## 影响分析

*   **临床风险**: 可能导致肺结节漏诊或误诊，影响患者治疗。
*   **产品信誉**: 若在实际使用中出现，将严重影响 MediScan 产品的可靠性和客户信任度。
*   **合规风险**: 对于需要获得医疗器械认证（如 NMPA）的产品，模型性能不稳定可能导致合规问题。

## 建议的后续步骤

1.  **数据分析**: 由数据科学团队 (陈浩) 深入分析 `HospitalB_SiemensXYZ_CT_Lung_Set03` 数据集的特征，与训练集进行比较。
2.  **模型重新评估**: 使用更多来自医院 B 或类似设备的数据对模型进行重新评估。
3.  **预处理检查**: 检查并验证图像预处理流程对不同来源数据的适应性。
4.  **Ground Truth 复核**: 安排其他专家对该数据集的 Ground Truth 进行独立复核。
5.  **模型调优/重新训练**: 根据分析结果，可能需要对模型进行微调或使用包含更多样化数据的训练集重新训练。

## 附件

*   `test_results_HospitalB_Set03.csv` (详细测试结果)
*   `sample_images_false_negatives.zip` (漏报病例样本图像)
*   `sample_images_false_positives.zip` (误报病例样本图像) 