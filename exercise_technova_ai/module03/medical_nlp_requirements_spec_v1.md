# NovaBrain 3.0 - 医疗自然语言处理 (NLP) 需求规格说明

**文档版本**: 1.2  
**日期**: 2023-11-15  
**状态**: 已评审  
**负责人**: 林小雨 (NLP 工程师), 王慧 (产品经理)

## 1. 概述

本文档定义了 NovaBrain 3.0 平台中医疗自然语言处理 (Medical NLP) 功能模块的需求规格。该模块旨在提供处理和理解中文医疗文本的能力，支持如电子病历分析、临床决策支持、医疗文献挖掘等应用场景。核心目标是准确、高效地从非结构化医疗文本中提取结构化信息。

## 2. 功能需求

### FR-MNLP-001: 中文医学命名实体识别 (NER)

*   **描述**: 系统应能识别并标注中文医疗文本中的预定义医学实体类型。
*   **实体类型**: (优先级从高到低)
    *   P0: 疾病诊断、症状体征、检查检验、药物名称、治疗操作、身体部位
    *   P1: 科室、时间信息 (病程相关)、指标名称、指标值、否定词、程度副词
    *   P2: 人群特征 (年龄、性别)、过敏史、家族史、医学设备
*   **要求**: 
    *   支持多种实体类型的识别。
    *   能够处理术语变体、缩写和别名 (需维护/引入医学词典)。
    *   实体边界识别准确。
    *   对于嵌套实体能够正确识别 (如 "左肺下叶结节")。
    *   性能: 在标准测试集上，核心实体类型 (P0) F1 值 ≥ 0.85。

### FR-MNLP-002: 医学实体关系抽取 (RE)

*   **描述**: 系统应能识别并抽取出实体之间的预定义语义关系。
*   **关系类型**: (优先级从高到低)
    *   P0: 药物-治疗-疾病, 检查-发现-疾病/症状, 症状-关联-身体部位, 治疗-操作于-身体部位
    *   P1: 检查-包含-指标, 指标-结果-值, 症状-修饰-程度
    *   P2: 药物-引发-不良反应, 疾病-并发-疾病
*   **要求**: 
    *   支持识别多种类型的实体关系。
    *   能够处理跨句子的关系抽取。
    *   性能: 在标准测试集上，核心关系类型 (P0) F1 值 ≥ 0.75。

### FR-MNLP-003: 医学实体属性抽取

*   **描述**: 系统应能识别并抽取出特定医学实体的属性信息。
*   **实体与属性**: (示例)
    *   疾病/症状: 是否定/肯定, 是否疑似, 时间描述 (持续时间, 发生时间), 严重程度
    *   药物: 剂量, 频率, 用法, 持续时间
    *   检查/检验: 结果值 (数值/阴阳性), 单位, 时间
    *   结节/肿瘤: 大小, 位置, 形态描述, 密度, CT值, 是否强化
*   **要求**: 
    *   支持抽取多种实体的关键属性。
    *   能处理数值和描述性属性。
    *   性能: 在标准测试集上，关键属性 (如否定/肯定, 数值) 抽取准确率 ≥ 0.90。

### FR-MNLP-004: 医学术语标准化/归一化

*   **描述**: 系统应能将识别出的非标准医学术语（如同义词、缩写、别名、口语化表达）映射到标准的医学术语或编码体系。
*   **目标标准库**: 
    *   ICD-10 (国际疾病分类)
    *   SNOMED CT (临床术语系统化命名法 - 中文版需确认)
    *   内部维护的标准术语词典 (包含常用缩写、别名)
*   **要求**: 
    *   提供可配置的映射规则或词典接口。
    *   支持模糊匹配和上下文消歧。
    *   对于无法明确映射的术语，应进行标记。
    *   性能: 在标准测试集上，核心术语标准化准确率 ≥ 0.80。

### FR-MNLP-005: 时间信息抽取与规范化

*   **描述**: 系统应能识别医疗文本中与病程、治疗、检查等相关的绝对和相对时间表述，并将其规范化。
*   **时间表述类型**: 年月日、时分秒、几天前/后、几周/月/年、持续时间等。
*   **规范化格式**: ISO 8601 或可配置的标准格式。
*   **要求**: 
    *   准确识别各类时间表述。
    *   结合上下文推断相对时间的基准点。
    *   处理时间区间的表述。

### FR-MNLP-006: 文本结构化输出

*   **描述**: 系统应能将 NLP 处理结果以结构化的格式输出。
*   **输出格式**: 
    *   JSON (包含实体、关系、属性、标准化结果等信息)
    *   (可选) 表格格式 (如 CSV)
*   **要求**: 
    *   输出格式清晰、规范、易于解析。
    *   包含原始文本与抽取信息的对应关系（如起止位置）。
    *   提供可配置的输出选项。

### FR-MNLP-007: 可配置性与可扩展性

*   **描述**: 系统应允许用户或管理员进行一定程度的配置和扩展。
*   **可配置项**: 
    *   启用的实体/关系类型
    *   标准化目标词典
    *   输出格式选项
*   **可扩展性**: 
    *   支持用户自定义实体/关系类型 (通过训练或规则)
    *   支持接入用户自定义的医学词典。
    *   提供 API 接口供二次开发和集成。

## 3. 非功能需求

### NFR-MNLP-001: 性能要求

*   **处理速度**: 对于单篇标准长度病历（约 1000-2000 字符），核心信息抽取（NER+RE+属性）的处理时间应小于 2 秒 (在标准硬件配置下)。
*   **吞吐量**: 在多核 CPU 或 GPU 环境下，应能支持至少 10 QPS 的并发处理能力。
*   **资源消耗**: 内存和 CPU 占用应在合理范围内，避免资源过度消耗。

### NFR-MNLP-002: 准确性要求

*   见各功能需求中的具体性能指标。
*   应提供模型评估报告，说明在标准测试集上的详细性能表现。

### NFR-MNLP-003: 可靠性要求

*   系统应能稳定运行，长时间处理任务时无明显性能下降或崩溃。
*   对于无法处理或解析错误的文本，应能优雅处理并返回错误信息，而非直接失败。

### NFR-MNLP-004: 安全与合规要求

*   处理过程应符合相关数据隐私法规（如 HIPAA, GDPR, 中国数据安全法）的要求。
*   对于传入的医疗文本数据，不应进行持久化存储（除非用户明确配置）。
*   所有涉及敏感数据的操作应有审计日志。
*   模型和词典的更新应有安全校验机制。

### NFR-MNLP-005: 可维护性要求

*   代码结构清晰，有良好的文档和注释。
*   模型、词典和规则应易于更新和管理。
*   提供清晰的错误日志和诊断信息。

## 4. 数据需求

*   **训练数据**: 需要大规模、高质量、多样化的中文医疗标注语料库，覆盖不同科室、文体和实体类型。
*   **验证/测试数据**: 需要独立的标注数据集，用于模型评估和性能测试。
*   **医学词典/知识库**: 需要接入或构建全面的中文医学词典，包含标准术语、缩写、别名、同义词等。
*   **数据来源**: 需确保所有训练和测试数据的来源合法合规，必要时获得伦理审查批准和患者知情同意。

## 5. 接口需求

*   提供 RESTful API 接口，支持文本输入和结构化结果输出。
*   API 应支持同步和异步处理模式。
*   API 应包含版本控制。
*   API 认证和授权应遵循平台统一规范。

## 6. 未来考虑 (Out of Scope for v3.0)

*   英文及其他语言医疗文本处理。
*   医疗文本自动摘要生成。
*   基于 NLP 的临床决策支持建议。
*   多模态信息融合（如结合影像报告与文本病历）。
*   模型在线持续学习能力。

## 7. 验收标准

*   所有 P0 功能需求按要求实现并通过测试。
*   核心性能指标（处理速度、吞吐量、F1值）达到预定目标。
*   系统在标准负载下稳定运行 72 小时以上。
*   通过安全和合规审查。
*   提供完整的 API 文档和用户手册。 