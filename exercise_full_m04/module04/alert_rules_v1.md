# NovaBrain 3.0 告警规则配置

## 告警级别定义

| 级别 | 名称 | 描述 | 通知方式 | 响应时间 |
|------|------|------|----------|----------|
| P1 | 严重 | 生产环境关键服务不可用，严重影响业务运行 | 电话+短信+邮件+企业微信 | 15分钟内 |
| P2 | 警告 | 生产环境出现异常，有潜在风险，但暂未严重影响业务 | 短信+邮件+企业微信 | 30分钟内 |
| P3 | 注意 | 非关键指标异常，需要关注但不紧急 | 企业微信+邮件 | 2小时内 |
| P4 | 信息 | 一般性通知，无需立即处理 | 邮件 | 下个工作日 |

## 系统关键告警规则

### 基础设施类

1. **服务器CPU高负载**
   - 条件: `cpu_usage > 90% for 5min`
   - 级别: P2
   - 执行操作: 通知运维团队，检查进程状态
   - 自动化操作: 无

2. **服务器内存紧张**
   - 条件: `memory_usage > 95% for 3min`
   - 级别: P2
   - 执行操作: 通知运维团队，分析内存使用情况
   - 自动化操作: 无

3. **磁盘空间不足**
   - 条件: `disk_usage > 90% for 10min`
   - 级别: P2
   - 执行操作: 通知运维团队，检查磁盘使用
   - 自动化操作: 无

### 应用服务类

4. **API高错误率**
   - 条件: `api_error_rate > 5% for 3min`
   - 级别: P1
   - 执行操作: 通知工程师和运维，分析错误日志
   - 自动化操作: 触发事故响应流程

5. **API延迟过高**
   - 条件: `api_latency_p99 > 1s for 5min`
   - 级别: P2
   - 执行操作: 通知工程师，分析性能瓶颈
   - 自动化操作: 无

### 数据库类

6. **数据库连接数接近上限**
   - 条件: `db_connection_usage > 90% for 5min`
   - 级别: P2
   - 执行操作: 通知DBA，检查连接泄漏
   - 自动化操作: 无

7. **数据库复制延迟过大**
   - 条件: `db_replication_lag > 60s for 5min`
   - 级别: P1
   - 执行操作: 通知DBA，分析复制问题
   - 自动化操作: 无

### 模型服务类

8. **模型服务错误率高**
   - 条件: `model_error_rate > 5% for 3min`
   - 级别: P1
   - 执行操作: 通知AI工程师和运维，分析错误原因
   - 自动化操作: 触发事故响应流程

9. **模型推理延迟过高**
   - 条件: `model_inference_latency_p95 > 1s for 5min`
   - 级别: P2
   - 执行操作: 通知AI工程师，分析性能问题
   - 自动化操作: 无

### 业务类

10. **登录失败率高**
    - 条件: `login_success_rate < 95% for 3min`
    - 级别: P1
    - 执行操作: 通知安全团队和运维，分析是否有安全事件
    - 自动化操作: 触发事故响应流程

11. **交易成功率下降**
    - 条件: `transaction_success_rate < 99% for 5min`
    - 级别: P1
    - 执行操作: 通知业务负责人和工程师，分析交易失败原因
    - 自动化操作: 触发事故响应流程
