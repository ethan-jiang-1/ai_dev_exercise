# 遗留系统集成规范

## 文档信息
- **文档编号**: INT-2025-002
- **版本**: 1.0
- **创建日期**: 2025年1月20日
- **最近更新**: 2025年1月20日
- **文档所有者**: 系统集成团队
- **机密级别**: 内部使用

## 1. 介绍

本文档详细描述了FinSecure风险评估平台需要集成的遗留系统，包括集成要求、技术规范、数据交换格式以及潜在的挑战和解决方案。本平台需要与多种现有银行和金融系统无缝集成，同时最小化对这些系统的改动。

## 2. 遗留系统清单

### 2.1 核心银行系统

#### 2.1.1 Mainframe Core Banking System (CBS-Legacy)
- **供应商**: IBM
- **版本**: z/OS 2.4, CICS 5.6
- **部署年份**: 2002年（多次升级）
- **主要功能**: 账户管理、交易处理、客户信息管理
- **数据库**: IBM DB2 v12
- **通信协议**: IBM MQ, VSAM文件传输
- **批处理窗口**: 每日23:00-02:00
- **日交易量**: ~500万笔

#### 2.1.2 Modern Core Banking Platform (NextGen-CBS)
- **供应商**: Temenos
- **版本**: T24 R20
- **部署年份**: 2018年
- **主要功能**: 账户管理、产品配置、利率管理、费用计算
- **数据库**: Oracle 19c
- **API**: REST API (已部分实现), SOAP Web Services
- **批处理窗口**: 每日22:00-01:00
- **日交易量**: ~800万笔

### 2.2 支付系统

#### 2.2.1 Card Payment System (CardPay)
- **供应商**: ACI Worldwide
- **版本**: BASE24-eps 7.0
- **部署年份**: 2016年
- **主要功能**: 信用卡/借记卡交易处理、授权、结算
- **数据库**: Oracle 18c
- **接口**: ISO 8583消息, TCP/IP
- **批处理**: 每4小时一次
- **峰值TPS**: 1500 TPS

#### 2.2.2 ACH Processing System (ACH-Connect)
- **供应商**: Finastra
- **版本**: Global PAYplus 7.2
- **部署年份**: 2019年
- **主要功能**: ACH转账、批量付款、退款处理
- **数据库**: Microsoft SQL Server 2017
- **接口**: SFTP文件传输, REST API
- **批处理**: 工作日5次/天
- **日交易量**: ~100万笔

### 2.3 现有风险管理系统

#### 2.3.1 AML监控系统 (ComplianceGuard)
- **供应商**: NICE Actimize
- **版本**: 9.2
- **部署年份**: 2012年
- **主要功能**: AML监控、KYC验证、制裁名单筛查
- **数据库**: Oracle 12c
- **接口**: 批量文件导入, SOAP Web Services
- **监控周期**: 每日、每周、每月
- **警报量**: ~5000/月

#### 2.3.2 欺诈检测系统 (TransactionShield)
- **供应商**: FICO
- **版本**: Falcon Fraud Manager 6.5
- **部署年份**: 2018年
- **主要功能**: 实时交易欺诈检测、行为分析
- **数据库**: Oracle 19c
- **接口**: REST API, JMS
- **响应时间**: ~250ms
- **误报率**: 约15%

#### 2.3.3 信用风险系统 (CreditSafe)
- **供应商**: Experian
- **版本**: PowerCurve 3.4
- **部署年份**: 2015年
- **主要功能**: 信用评分、申请处理、限额管理
- **数据库**: Oracle 18c
- **接口**: SFTP文件交换, SOAP Web Services
- **批处理**: 每日
- **评分请求**: ~50,000/天

## 3. 集成要求

### 3.1 数据流向

```
┌─────────────────┐      ┌───────────────────┐      ┌───────────────────┐
│  交易来源系统   │─────>│ FinSecure风险平台 │─────>│ 业务处理系统      │
│ (CBS, 支付系统) │      │                   │      │ (核心银行, 支付)  │
└─────────────────┘      └───────────────────┘      └───────────────────┘
       │                          ^                          │
       │                          │                          │
       └──────────────────────────┴──────────────────────────┘
                            数据反馈循环
```

### 3.2 集成模式

1. **实时集成**:
   - 交易前风险评估: 授权前风险检查
   - 交易后分析: 完成后立即分析
   - 阈值超过时实时警报

2. **近实时集成**:
   - 微批处理(5-15分钟间隔)
   - 复杂模式检测
   - 跨交易关联分析

3. **批量集成**:
   - 每日数据仓库加载
   - 历史数据分析
   - 模型训练和调优

### 3.3 数据交换格式

- **JSON**: 用于大多数现代系统API集成
- **XML**: 用于SOAP Web Services调用
- **CSV/固定宽度文件**: 用于批量数据交换
- **ISO 8583**: 支付卡交易
- **SWIFT MT/MX消息**: 跨境支付信息
- **专有格式**: 针对特定遗留系统的定制格式

## 4. 技术集成方法

### 4.1 API集成

| 系统 | API类型 | 认证方式 | 数据格式 | 端点数 | 平均响应时间 |
|-----|---------|---------|---------|--------|------------|
| NextGen-CBS | REST | OAuth 2.0 + JWT | JSON | 78 | 180ms |
| CardPay | REST | API密钥 | JSON | 32 | 150ms |
| TransactionShield | REST | OAuth 2.0 | JSON | 45 | 200ms |
| CreditSafe | SOAP | WS-Security | XML | 27 | 350ms |
| ComplianceGuard | SOAP | 基本认证 | XML | 18 | 450ms |

### 4.2 消息队列集成

| 系统 | 消息中间件 | 主题/队列 | 消息格式 | 平均吞吐量 | 持久化策略 |
|-----|------------|----------|---------|-----------|-----------|
| CBS-Legacy | IBM MQ | ACCT.UPDATE, TXN.NEW | 专有二进制 | 2000 msgs/s | 磁盘同步 |
| NextGen-CBS | Apache Kafka | accounts, transactions, customers | JSON | 5000 msgs/s | 多副本 |
| CardPay | RabbitMQ | card.auth, card.settle | JSON | 1500 msgs/s | 镜像队列 |

### 4.3 文件传输集成

| 系统 | 传输方式 | 文件格式 | 加密方法 | 频率 | 平均文件大小 |
|-----|---------|---------|---------|------|------------|
| CBS-Legacy | SFTP | 固定宽度 | PGP | 每小时 | 100MB |
| ACH-Connect | SFTP | CSV | PGP | 每日5次 | 250MB |
| ComplianceGuard | SFTP | XML | PGP | 每日 | 500MB |
| CreditSafe | SFTP | CSV | PGP | 每日 | 150MB |

### 4.4 数据库直连

| 系统 | 连接类型 | 访问权限 | 刷新频率 | 连接池大小 |
|-----|---------|---------|---------|-----------|
| CBS-Legacy | DB2 CDC | 只读副本 | 近实时 | 25 |
| NextGen-CBS | Oracle Golden Gate | 只读副本 | 近实时 | 50 |
| CardPay | 只读视图 | 只读 | 15分钟 | 20 |

## 5. 集成挑战与解决方案

### 5.1 Mainframe系统集成挑战

- **挑战**: 有限的API能力，主要依赖批处理和文件传输
- **解决方案**: 
  1. 使用IBM MQ作为实时交易通知渠道
  2. 部署变更数据捕获(CDC)工具监控关键表
  3. 开发适配器转换EBCDIC和ASCII编码
  4. 实现中间件缓存最近交易以减少直接查询

### 5.2 数据质量与一致性挑战

- **挑战**: 跨系统的客户标识符不一致，数据格式差异
- **解决方案**:
  1. 建立统一客户标识映射服务
  2. 实现规范化引擎处理不同来源的数据
  3. 建立数据质量规则和验证服务
  4. 维护主数据管理(MDM)系统同步关键实体

### 5.3 性能与可用性挑战

- **挑战**: 遗留系统的性能限制，批处理窗口约束
- **解决方案**:
  1. 实现请求限流和优先级队列
  2. 部署缓存层减少直接查询频率
  3. 使用读取副本和近线存储
  4. 设计降级策略应对系统不可用

### 5.4 安全与合规挑战

- **挑战**: 不同安全模型，敏感数据处理要求
- **解决方案**:
  1. 实现端到端加密
  2. 部署API网关统一认证和授权
  3. 实施数据屏蔽和标记化处理PII数据
  4. 建立全面的审计日志记录所有系统交互

## 6. 集成测试策略

### 6.1 测试环境

| 环境层次 | 包含系统 | 数据类型 | 测试重点 | 刷新频率 |
|---------|---------|---------|---------|---------|
| 单元测试 | 模拟/存根 | 合成数据 | 适配器逻辑 | 持续 |
| 集成测试 | 系统测试实例 | 屏蔽生产数据 | 端到端数据流 | 每周 |
| 用户验收 | 预生产系统 | 屏蔽生产数据 | 业务场景 | 每月 |
| 性能测试 | 规模化测试环境 | 大量合成数据 | 负载和压力测试 | 按需 |

### 6.2 测试数据管理

- 为每个遗留系统维护一组代表性测试数据
- 实现测试数据生成器创建大量合成交易
- 使用数据屏蔽工具处理生产数据副本
- 维护跨系统的一致测试用例

## 7. 部署与发布策略

### 7.1 过渡策略

- **阶段1**: 只读集成，风险分析结果不影响业务决策
- **阶段2**: 混合模式，新系统建议与现有系统并行评估
- **阶段3**: 完全切换，新系统成为主要风险决策引擎

### 7.2 回滚策略

- 每个集成点保持现有系统功能不变
- 维护决策路由配置，可快速切换回遗留系统
- 建立监控指标触发自动回滚
- 保存所有评估结果用于事后分析

## 8. 服务等级协议(SLA)

| 集成方式 | 可用性要求 | 性能要求 | 故障恢复时间 | 支持窗口 |
|---------|----------|---------|------------|---------|
| 实时API | 99.99% | <300ms P95响应 | <5分钟 | 24x7 |
| 消息队列 | 99.95% | <1秒处理延迟 | <15分钟 | 24x7 |
| 批量文件 | 99.9% | 每小时传输窗口 | <30分钟 | 工作日 8x5 |

## 9. 附录

### 附录A: 系统拓扑图

[系统拓扑图展示所有遗留系统与新平台的连接]

### 附录B: 数据映射规范

[详细的字段映射文档]

### 附录C: 认证凭证管理流程

[凭证轮换和安全管理流程]

### 附录D: 参考架构

[各系统集成的参考架构和设计模式] 