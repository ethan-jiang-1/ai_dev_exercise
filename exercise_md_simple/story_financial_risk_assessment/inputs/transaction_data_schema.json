{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "FinSecure Transaction Data Schema",
  "description": "Schema definition for financial transaction data used in the FinSecure Risk Assessment Platform",
  "type": "object",
  "version": "2.3.0",
  "lastUpdated": "2025-01-15",
  "required": [
    "transaction_id",
    "timestamp",
    "amount",
    "currency",
    "transaction_type",
    "status",
    "source",
    "destination"
  ],
  "properties": {
    "transaction_id": {
      "type": "string",
      "description": "Unique identifier for the transaction",
      "pattern": "^[A-Za-z0-9]{8,32}$",
      "examples": ["TRX123456789", "PAY987654321"]
    },
    "timestamp": {
      "type": "string",
      "format": "date-time",
      "description": "ISO 8601 timestamp when the transaction was initiated",
      "examples": ["2025-01-15T14:30:00Z"]
    },
    "amount": {
      "type": "number",
      "description": "Transaction amount in the specified currency",
      "exclusiveMinimum": 0,
      "examples": [125.50, 1000.00]
    },
    "currency": {
      "type": "string",
      "description": "ISO 4217 currency code",
      "pattern": "^[A-Z]{3}$",
      "examples": ["USD", "EUR", "GBP", "JPY"]
    },
    "transaction_type": {
      "type": "string",
      "description": "Type of financial transaction",
      "enum": [
        "payment",
        "transfer",
        "deposit",
        "withdrawal",
        "forex",
        "loan_disbursement",
        "loan_repayment",
        "refund",
        "chargeback",
        "adjustment",
        "fee",
        "investment",
        "dividend",
        "insurance_premium",
        "insurance_claim",
        "tax_payment",
        "other"
      ],
      "examples": ["payment", "transfer"]
    },
    "status": {
      "type": "string",
      "description": "Current status of the transaction",
      "enum": [
        "initiated",
        "pending",
        "processing",
        "completed",
        "declined",
        "failed",
        "reversed",
        "under_review",
        "cancelled"
      ],
      "examples": ["completed", "pending"]
    },
    "processing_time_ms": {
      "type": "integer",
      "description": "Time taken to process the transaction in milliseconds",
      "minimum": 0,
      "examples": [250, 1200]
    },
    "reference_id": {
      "type": "string",
      "description": "External reference ID from originating system",
      "examples": ["REF123456", "ORD-98765"]
    },
    "description": {
      "type": "string",
      "description": "Human-readable description of the transaction",
      "maxLength": 255,
      "examples": ["Monthly subscription payment", "Salary transfer"]
    },
    "category": {
      "type": "string",
      "description": "Business category of the transaction",
      "examples": ["retail", "entertainment", "utility", "healthcare", "education"]
    },
    "mcc": {
      "type": "string",
      "description": "Merchant Category Code (for card transactions)",
      "pattern": "^[0-9]{4}$",
      "examples": ["5411", "7011"]
    },
    "source": {
      "type": "object",
      "description": "Source of the transaction funds",
      "required": ["account_id", "account_type"],
      "properties": {
        "account_id": {
          "type": "string",
          "description": "Identifier for the source account",
          "examples": ["ACC123456789"]
        },
        "account_type": {
          "type": "string",
          "description": "Type of the source account",
          "enum": ["checking", "savings", "credit", "loan", "investment", "digital_wallet", "other"],
          "examples": ["checking", "credit"]
        },
        "institution_id": {
          "type": "string",
          "description": "Identifier for the financial institution",
          "examples": ["BANK001", "COOP002"]
        },
        "institution_name": {
          "type": "string",
          "description": "Name of the financial institution",
          "examples": ["Global Bank", "City Credit Union"]
        },
        "country": {
          "type": "string",
          "description": "ISO 3166-1 alpha-2 country code",
          "pattern": "^[A-Z]{2}$",
          "examples": ["US", "GB", "DE"]
        }
      }
    },
    "destination": {
      "type": "object",
      "description": "Destination for the transaction funds",
      "required": ["account_id", "account_type"],
      "properties": {
        "account_id": {
          "type": "string",
          "description": "Identifier for the destination account",
          "examples": ["ACC987654321"]
        },
        "account_type": {
          "type": "string",
          "description": "Type of the destination account",
          "enum": ["checking", "savings", "credit", "loan", "investment", "digital_wallet", "other"],
          "examples": ["savings", "digital_wallet"]
        },
        "institution_id": {
          "type": "string",
          "description": "Identifier for the financial institution",
          "examples": ["BANK003", "COOP004"]
        },
        "institution_name": {
          "type": "string",
          "description": "Name of the financial institution",
          "examples": ["National Bank", "Metro Credit Union"]
        },
        "country": {
          "type": "string",
          "description": "ISO 3166-1 alpha-2 country code",
          "pattern": "^[A-Z]{2}$",
          "examples": ["US", "CA", "FR"]
        },
        "beneficiary_name": {
          "type": "string",
          "description": "Name of the beneficiary (for transfers)",
          "examples": ["John Smith", "Acme Corporation"]
        }
      }
    },
    "payment_method": {
      "type": "object",
      "description": "Payment method details (for payment transactions)",
      "properties": {
        "type": {
          "type": "string",
          "description": "Type of payment method",
          "enum": ["credit_card", "debit_card", "bank_transfer", "direct_debit", "digital_wallet", "crypto", "cash", "check", "other"],
          "examples": ["credit_card", "digital_wallet"]
        },
        "card": {
          "type": "object",
          "description": "Card details (if payment method is card-based)",
          "properties": {
            "last_four": {
              "type": "string",
              "description": "Last four digits of the card",
              "pattern": "^[0-9]{4}$",
              "examples": ["1234", "5678"]
            },
            "bin": {
              "type": "string",
              "description": "Bank Identification Number (first 6 digits)",
              "pattern": "^[0-9]{6}$",
              "examples": ["411111", "511111"]
            },
            "token": {
              "type": "string",
              "description": "Tokenized card representation",
              "examples": ["tok_Vg1a2b3c4d5e6f"]
            },
            "issuer": {
              "type": "string",
              "description": "Card issuing bank or institution",
              "examples": ["Global Bank", "Premier Bank"]
            },
            "card_present": {
              "type": "boolean",
              "description": "Whether the card was physically present for the transaction",
              "examples": [true, false]
            },
            "card_type": {
              "type": "string",
              "description": "Type of card used",
              "enum": ["credit", "debit", "prepaid", "other"],
              "examples": ["credit", "debit"]
            },
            "network": {
              "type": "string",
              "description": "Card network",
              "enum": ["visa", "mastercard", "amex", "discover", "jcb", "unionpay", "other"],
              "examples": ["visa", "mastercard"]
            }
          }
        },
        "digital_wallet": {
          "type": "object",
          "description": "Digital wallet details (if payment method is digital wallet)",
          "properties": {
            "provider": {
              "type": "string",
              "description": "Digital wallet provider",
              "examples": ["PayPal", "Apple Pay", "Google Pay", "Venmo"]
            },
            "account_id": {
              "type": "string",
              "description": "Account identifier in the wallet system",
              "examples": ["wallet_12345abcde"]
            },
            "email": {
              "type": "string",
              "format": "email",
              "description": "Email associated with the wallet (redacted/tokenized for privacy)",
              "examples": ["j****@example.com"]
            }
          }
        }
      }
    },
    "fees": {
      "type": "array",
      "description": "Fees associated with the transaction",
      "items": {
        "type": "object",
        "required": ["type", "amount", "currency"],
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of fee",
            "enum": ["processing", "service", "exchange", "network", "other"],
            "examples": ["processing", "exchange"]
          },
          "amount": {
            "type": "number",
            "description": "Fee amount",
            "minimum": 0,
            "examples": [2.50, 5.00]
          },
          "currency": {
            "type": "string",
            "description": "ISO 4217 currency code for the fee",
            "pattern": "^[A-Z]{3}$",
            "examples": ["USD", "EUR"]
          },
          "description": {
            "type": "string",
            "description": "Description of the fee",
            "examples": ["Payment processing fee", "Currency exchange fee"]
          }
        }
      }
    },
    "exchange_rate": {
      "type": "object",
      "description": "Exchange rate details for cross-currency transactions",
      "properties": {
        "from_currency": {
          "type": "string",
          "description": "Source currency code (ISO 4217)",
          "pattern": "^[A-Z]{3}$",
          "examples": ["USD", "EUR"]
        },
        "to_currency": {
          "type": "string",
          "description": "Destination currency code (ISO 4217)",
          "pattern": "^[A-Z]{3}$",
          "examples": ["GBP", "JPY"]
        },
        "rate": {
          "type": "number",
          "description": "Exchange rate applied",
          "exclusiveMinimum": 0,
          "examples": [1.21, 0.83]
        },
        "provider": {
          "type": "string",
          "description": "Exchange rate provider",
          "examples": ["Global Currency Exchange", "Bank Rate"]
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Time when the exchange rate was determined",
          "examples": ["2025-01-15T14:29:30Z"]
        },
        "markup_percentage": {
          "type": "number",
          "description": "Markup percentage applied to the base exchange rate",
          "minimum": 0,
          "examples": [2.5, 3.0]
        }
      }
    },
    "risk_indicators": {
      "type": "object",
      "description": "Risk indicators for the transaction (populated by risk systems)",
      "properties": {
        "velocity_check": {
          "type": "object",
          "description": "Transaction velocity checks",
          "properties": {
            "count_1h": {
              "type": "integer",
              "description": "Number of transactions in the last hour",
              "minimum": 0,
              "examples": [3, 5]
            },
            "count_24h": {
              "type": "integer",
              "description": "Number of transactions in the last 24 hours",
              "minimum": 0,
              "examples": [12, 20]
            },
            "amount_24h": {
              "type": "number",
              "description": "Total amount in the last 24 hours",
              "minimum": 0,
              "examples": [1200.00, 5000.00]
            }
          }
        },
        "device_risk": {
          "type": "object",
          "description": "Risk indicators related to the device used",
          "properties": {
            "ip_address": {
              "type": "string",
              "description": "IP address used (redacted/tokenized for privacy)",
              "examples": ["ip_a1b2c3d4"]
            },
            "ip_country": {
              "type": "string",
              "description": "Country associated with the IP address",
              "pattern": "^[A-Z]{2}$",
              "examples": ["US", "GB"]
            },
            "device_id": {
              "type": "string",
              "description": "Device identifier (tokenized)",
              "examples": ["dev_1a2b3c4d5e"]
            },
            "device_type": {
              "type": "string",
              "description": "Type of device used",
              "examples": ["mobile", "desktop", "tablet"]
            },
            "browser": {
              "type": "string",
              "description": "Browser used",
              "examples": ["Chrome", "Safari", "Firefox"]
            },
            "operating_system": {
              "type": "string",
              "description": "Operating system used",
              "examples": ["iOS", "Android", "Windows", "macOS"]
            },
            "previously_seen": {
              "type": "boolean",
              "description": "Whether this device has been seen before for this user",
              "examples": [true, false]
            },
            "geolocation": {
              "type": "object",
              "description": "Geolocation information (if available)",
              "properties": {
                "latitude": {
                  "type": "number",
                  "description": "Latitude coordinate",
                  "minimum": -90,
                  "maximum": 90,
                  "examples": [40.7128, -74.0060]
                },
                "longitude": {
                  "type": "number",
                  "description": "Longitude coordinate",
                  "minimum": -180,
                  "maximum": 180,
                  "examples": [-74.0060, 100.5018]
                },
                "accuracy": {
                  "type": "number",
                  "description": "Accuracy of geolocation in meters",
                  "minimum": 0,
                  "examples": [10, 50]
                }
              }
            }
          }
        },
        "anomaly_indicators": {
          "type": "object",
          "description": "Indicators of anomalous behavior",
          "properties": {
            "unusual_amount": {
              "type": "boolean",
              "description": "Whether the transaction amount is unusual for this user",
              "examples": [true, false]
            },
            "unusual_time": {
              "type": "boolean",
              "description": "Whether the transaction time is unusual for this user",
              "examples": [true, false]
            },
            "unusual_location": {
              "type": "boolean",
              "description": "Whether the transaction location is unusual for this user",
              "examples": [true, false]
            },
            "unusual_beneficiary": {
              "type": "boolean",
              "description": "Whether the beneficiary is unusual for this user",
              "examples": [true, false]
            },
            "behavior_deviation_score": {
              "type": "number",
              "description": "Score indicating deviation from normal behavior (0-1)",
              "minimum": 0,
              "maximum": 1,
              "examples": [0.12, 0.85]
            }
          }
        },
        "aml_flags": {
          "type": "object",
          "description": "Anti-Money Laundering risk flags",
          "properties": {
            "structuring_suspected": {
              "type": "boolean",
              "description": "Whether structuring behavior is suspected",
              "examples": [true, false]
            },
            "high_risk_country": {
              "type": "boolean",
              "description": "Whether transaction involves a high-risk country",
              "examples": [true, false]
            },
            "sanctioned_entity": {
              "type": "boolean",
              "description": "Whether transaction involves a sanctioned entity",
              "examples": [true, false]
            },
            "politically_exposed": {
              "type": "boolean",
              "description": "Whether transaction involves a politically exposed person",
              "examples": [true, false]
            },
            "suspicious_pattern": {
              "type": "boolean",
              "description": "Whether transaction fits a suspicious pattern",
              "examples": [true, false]
            }
          }
        }
      }
    },
    "risk_scores": {
      "type": "object",
      "description": "Risk scores generated by risk models (populated by risk systems)",
      "properties": {
        "fraud_score": {
          "type": "number",
          "description": "Fraud risk score (0-1, higher is riskier)",
          "minimum": 0,
          "maximum": 1,
          "examples": [0.05, 0.87]
        },
        "aml_score": {
          "type": "number",
          "description": "Anti-Money Laundering risk score (0-1, higher is riskier)",
          "minimum": 0,
          "maximum": 1,
          "examples": [0.02, 0.65]
        },
        "credit_risk_score": {
          "type": "number",
          "description": "Credit risk score (0-1, higher is riskier)",
          "minimum": 0,
          "maximum": 1,
          "examples": [0.15, 0.75]
        },
        "overall_risk_score": {
          "type": "number",
          "description": "Overall risk score combining multiple risk factors (0-1, higher is riskier)",
          "minimum": 0,
          "maximum": 1,
          "examples": [0.10, 0.80]
        },
        "model_version": {
          "type": "string",
          "description": "Version of the risk model used",
          "examples": ["1.2.3", "2.0.1"]
        },
        "confidence": {
          "type": "number",
          "description": "Confidence in the risk assessment (0-1, higher is more confident)",
          "minimum": 0,
          "maximum": 1,
          "examples": [0.85, 0.95]
        }
      }
    },
    "decision": {
      "type": "object",
      "description": "Risk decision details (populated by decision engine)",
      "properties": {
        "action": {
          "type": "string",
          "description": "Action taken based on risk assessment",
          "enum": ["approve", "review", "decline", "escalate", "additional_verification"],
          "examples": ["approve", "review"]
        },
        "reason_code": {
          "type": "string",
          "description": "Code representing the reason for the decision",
          "examples": ["RC001", "RC205"]
        },
        "reason": {
          "type": "string",
          "description": "Human-readable reason for the decision",
          "examples": ["Transaction approved", "Flagged for manual review due to unusual amount"]
        },
        "rules_triggered": {
          "type": "array",
          "description": "List of risk rules that were triggered",
          "items": {
            "type": "object",
            "properties": {
              "rule_id": {
                "type": "string",
                "description": "Identifier for the rule",
                "examples": ["RULE123", "RULE456"]
              },
              "description": {
                "type": "string",
                "description": "Description of the rule",
                "examples": ["Unusual transaction amount", "New beneficiary"]
              },
              "severity": {
                "type": "string",
                "description": "Severity level of the rule",
                "enum": ["low", "medium", "high", "critical"],
                "examples": ["medium", "high"]
              }
            }
          }
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Time when the decision was made",
          "examples": ["2025-01-15T14:30:05Z"]
        },
        "processing_time_ms": {
          "type": "integer",
          "description": "Time taken to make the decision in milliseconds",
          "minimum": 0,
          "examples": [50, 120]
        },
        "reviewer_id": {
          "type": "string",
          "description": "Identifier of the manual reviewer (if reviewed)",
          "examples": ["REV123", "REV456"]
        }
      }
    },
    "compliance": {
      "type": "object",
      "description": "Compliance-related information",
      "properties": {
        "regulatory_reports": {
          "type": "array",
          "description": "Regulatory reports filed for this transaction",
          "items": {
            "type": "object",
            "properties": {
              "report_type": {
                "type": "string",
                "description": "Type of regulatory report",
                "examples": ["SAR", "CTR", "STR"]
              },
              "report_id": {
                "type": "string",
                "description": "Identifier for the report",
                "examples": ["SAR-12345", "CTR-67890"]
              },
              "filing_date": {
                "type": "string",
                "format": "date",
                "description": "Date when the report was filed",
                "examples": ["2025-01-16"]
              },
              "authority": {
                "type": "string",
                "description": "Regulatory authority the report was filed with",
                "examples": ["FinCEN", "FCA", "FINTRAC"]
              }
            }
          }
        },
        "verification_results": {
          "type": "array",
          "description": "Results of compliance verifications",
          "items": {
            "type": "object",
            "properties": {
              "verification_type": {
                "type": "string",
                "description": "Type of verification performed",
                "examples": ["sanctions_screening", "pep_screening", "id_verification"]
              },
              "result": {
                "type": "string",
                "description": "Result of the verification",
                "enum": ["pass", "fail", "review", "not_applicable"],
                "examples": ["pass", "review"]
              },
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "Time when the verification was performed",
                "examples": ["2025-01-15T14:29:45Z"]
              },
              "details": {
                "type": "string",
                "description": "Additional details about the verification",
                "examples": ["No matches found", "Potential match requiring review"]
              }
            }
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional metadata about the transaction",
      "properties": {
        "channel": {
          "type": "string",
          "description": "Channel through which the transaction was initiated",
          "examples": ["mobile_app", "web", "branch", "atm", "api"]
        },
        "user_agent": {
          "type": "string",
          "description": "User agent string from the client device",
          "examples": ["Mozilla/5.0 (iPhone; CPU iPhone OS 18_0 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/18.0 Mobile/15E148 Safari/604.1"]
        },
        "session_id": {
          "type": "string",
          "description": "Session identifier for the user session",
          "examples": ["sess_1a2b3c4d5e6f"]
        },
        "integration_partner": {
          "type": "string",
          "description": "Third-party integration partner (if applicable)",
          "examples": ["PaymentProcessor123", "FinTechApp456"]
        },
        "batch_id": {
          "type": "string",
          "description": "Batch identifier (for batch processing)",
          "examples": ["BATCH123", "BATCH456"]
        },
        "correlation_id": {
          "type": "string",
          "description": "Identifier for correlating related transactions",
          "examples": ["CORR123", "CORR456"]
        },
        "custom_fields": {
          "type": "object",
          "description": "Custom fields specific to the implementation",
          "additionalProperties": true
        }
      }
    },
    "audit": {
      "type": "object",
      "description": "Audit information for the transaction",
      "properties": {
        "created_at": {
          "type": "string",
          "format": "date-time",
          "description": "Time when the record was created",
          "examples": ["2025-01-15T14:30:00Z"]
        },
        "created_by": {
          "type": "string",
          "description": "Identifier of the entity that created the record",
          "examples": ["SYSTEM", "USER123"]
        },
        "updated_at": {
          "type": "string",
          "format": "date-time",
          "description": "Time when the record was last updated",
          "examples": ["2025-01-15T14:35:10Z"]
        },
        "updated_by": {
          "type": "string",
          "description": "Identifier of the entity that last updated the record",
          "examples": ["SYSTEM", "USER456"]
        },
        "version": {
          "type": "integer",
          "description": "Version number of the record",
          "minimum": 1,
          "examples": [1, 2]
        },
        "changes": {
          "type": "array",
          "description": "Record of changes made to the transaction",
          "items": {
            "type": "object",
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time",
                "description": "Time when the change was made",
                "examples": ["2025-01-15T14:35:10Z"]
              },
              "field": {
                "type": "string",
                "description": "Field that was changed",
                "examples": ["status", "decision.action"]
              },
              "old_value": {
                "type": ["string", "number", "boolean", "null"],
                "description": "Previous value of the field",
                "examples": ["pending", 100.00]
              },
              "new_value": {
                "type": ["string", "number", "boolean", "null"],
                "description": "New value of the field",
                "examples": ["completed", 150.00]
              },
              "changed_by": {
                "type": "string",
                "description": "Identifier of the entity that made the change",
                "examples": ["SYSTEM", "USER789"]
              },
              "reason": {
                "type": "string",
                "description": "Reason for the change",
                "examples": ["Automatic update", "Manual correction"]
              }
            }
          }
        }
      }
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "transaction_id": "TRX123456789",
      "timestamp": "2025-01-15T14:30:00Z",
      "amount": 125.50,
      "currency": "USD",
      "transaction_type": "payment",
      "status": "completed",
      "processing_time_ms": 250,
      "reference_id": "REF123456",
      "description": "Monthly subscription payment",
      "category": "retail",
      "mcc": "5411",
      "source": {
        "account_id": "ACC123456789",
        "account_type": "credit",
        "institution_id": "BANK001",
        "institution_name": "Global Bank",
        "country": "US"
      },
      "destination": {
        "account_id": "ACC987654321",
        "account_type": "checking",
        "institution_id": "BANK003",
        "institution_name": "National Bank",
        "country": "US",
        "beneficiary_name": "Acme Corporation"
      },
      "payment_method": {
        "type": "credit_card",
        "card": {
          "last_four": "1234",
          "bin": "411111",
          "token": "tok_Vg1a2b3c4d5e6f",
          "issuer": "Global Bank",
          "card_present": false,
          "card_type": "credit",
          "network": "visa"
        }
      },
      "fees": [
        {
          "type": "processing",
          "amount": 2.50,
          "currency": "USD",
          "description": "Payment processing fee"
        }
      ],
      "risk_scores": {
        "fraud_score": 0.05,
        "aml_score": 0.02,
        "credit_risk_score": 0.15,
        "overall_risk_score": 0.10,
        "model_version": "1.2.3",
        "confidence": 0.95
      },
      "decision": {
        "action": "approve",
        "reason_code": "RC001",
        "reason": "Transaction approved",
        "timestamp": "2025-01-15T14:30:05Z",
        "processing_time_ms": 50
      },
      "metadata": {
        "channel": "mobile_app",
        "session_id": "sess_1a2b3c4d5e6f"
      },
      "audit": {
        "created_at": "2025-01-15T14:30:00Z",
        "created_by": "SYSTEM",
        "updated_at": "2025-01-15T14:30:05Z",
        "updated_by": "SYSTEM",
        "version": 1
      }
    }
  ]
} 